// 부적절한 단어 필터 (확장판)
const PROFANITY_LIST = [
    // 욕설
    '씨발', '시발', 'ㅅㅂ', 'ㅆㅂ', '시바', '씨바', '씨팔', '시팔',
    '개새', '개색', '개새끼', '개색끼', 'ㄱㅅㄲ',
    '병신', 'ㅂㅅ', '병쉰', '병딱',
    '새끼', 'ㅅㄲ', '쉐끼', '쌔끼',
    '지랄', 'ㅈㄹ', '지럴',
    '닥쳐', '닥처', '다쳐',
    '꺼져', '꺼저', '거져',
    '죽어', '뒤져', '디져',
    '미친', '미쳤', '미침',
    '또라이', '똘아이',
    '멍청', '멍충',
    '바보', '빠보',
    '등신', '등쉰',
    '찐따', '찐다',
    '빡대가리', '빡대머리',
    '엿먹어', '엿이나',
    '좆', '좃', 'ㅈ', '자지',
    
    // 비속어
    '엿같', '엿같은',
    '개같', '개같은', '개처럼',
    '좆같', '좆같은',
    '존나', 'ㅈㄴ', '존만', '졸라', 'ㅈㄹ',
    '썅', '씹', '띠발', '뒤질',
    '애미', '애비', '호로', '창녀',
    '쓰레기', '인간쓰레기',
    
    // 음란 용어
    '섹스', 'sex', '섹쓰', '쎅스',
    '야동', '야딩',
    '포르노', '포루노',
    '음란', '음담패설',
    '야한', '섹시',
    '자위', '딸치', '딸질',
    '음경', '성기', '생식기',
    '나체', '벗은', '알몸',
    '가슴', '젖가슴', '유방',
    '엉덩이', '궁둥이', '볼기',
    '19금', '19세', 'ㅅㅅ',
    
    // 폭력/위협
    '죽여', '패', '때려', '쳐라', '쳐',
    '폭행', '구타', '학대',
    '칼', '총', '폭탄',
    '피', '피를', '살인',
    '때리', '맞아', '맞을',
    
    // 차별/혐오
    '장애인', '장애아', '장애',
    '정신병', '정신질환',
    '똥', '똥을', '똥이',
    '오줌', '방귀', '토할', '토해',
    '더러', '지저분', '역겨',
    '징그럽', '구역질',
    
    // 무의미한 반복/도배
    'ㅋㅋㅋㅋㅋㅋㅋㅋㅋㅋ', 'ㅎㅎㅎㅎㅎㅎㅎㅎㅎㅎ',
    'ㄱㄱㄱㄱㄱㄱㄱㄱ', 'ㅁㅁㅁㅁㅁㅁㅁㅁ',
];

// 변형된 형태도 감지 (자음/모음 분리, 띄어쓰기 등)
const PATTERN_LIST = [
    /[씨시]\s*[발빨팔]/i,
    /개\s*[새색](\s*[끼키])?/i,
    /병\s*신/i,
    /[새쇄색]\s*[끼키]/i,
    /[지쥐]\s*랄/i,
    /[닥다]\s*[쳐처]/i,
    /꺼\s*져/i,
    /죽\s*[어이]/i,
    /[섹세]\s*[스쓰]/i,
    /존\s*나/i,
    /[좆좃]\s*[같갔]/i,
    /엿\s*[먹멕]/i,
    // 무의미한 반복 (같은 글자 10개 이상)
    /(.)\1{9,}/,
    // ㅋㅋㅋ... 과도한 반복
    /[ㅋㄱ]{10,}/,
    /[ㅎㅇ]{10,}/,
];

/**
 * 텍스트에 부적절한 단어가 포함되어 있는지 검사
 */
export function containsProfanity(text: string): boolean {
    if (!text) return false;
    
    const lowerText = text.toLowerCase().trim();
    
    // 직접 매칭
    for (const word of PROFANITY_LIST) {
        if (lowerText.includes(word.toLowerCase())) {
            return true;
        }
    }
    
    // 패턴 매칭
    for (const pattern of PATTERN_LIST) {
        if (pattern.test(lowerText)) {
            return true;
        }
    }
    
    return false;
}

/**
 * 부적절한 단어를 검출하고 경고 메시지 반환
 */
export function validateText(text: string): { isValid: boolean; message?: string } {
    if (!text || text.trim().length === 0) {
        return { isValid: false, message: '내용을 입력해주세요.' };
    }
    
    // 너무 짧은 입력 (1글자)
    if (text.trim().length < 2) {
        return { isValid: false, message: '최소 2글자 이상 입력해주세요.' };
    }
    
    // 부적절한 단어 체크
    if (containsProfanity(text)) {
        return { 
            isValid: false, 
            message: '🚫 부적절한 단어가 포함되어 있습니다. 올바른 단어를 사용해주세요!' 
        };
    }
    
    return { isValid: true };
}
